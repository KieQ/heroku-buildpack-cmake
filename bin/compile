#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -e
set -o pipefail

# environment
BUILD_DIR=$1
CACHE_DIR=$2
CC=gcc-9
CXX=g++-9


# make bin directory to hold the temporary files
cd $BUILD_DIR
mkdir bin
cd bin

echo "-----> Install common dependency"
apt update && apt install -y libboost-dev

echo "-----> Download git submodule"
git submodule update --init --recursive

echo "-----> Compiling with CMake"
cmake .. -DCMAKE_BUILD_TYPE=Release

echo "-----> Install with make"
make
make install
rm -rf bin
